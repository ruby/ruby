$(TARGET_SO) $(STATIC_LIB): $(FAILURES:.cpp=.failed)

.SUFFIXES: .failed

.cpp.failed:
	$(Q)$(RUBY) -rfileutils \
	  -e "t = ARGV.shift" \
	  -e "err = IO.popen(ARGV, err:[:child, :out], &:read)" \
	  -e "abort err unless /rb_define_method/ =~ err" \
	  -e "File.write(t, err)" $@ $(MAKE) $(*F).o

# AUTOGENERATED DEPENDENCIES START
cxxanyargs.o: $(RUBY_EXTCONF_H)
cxxanyargs.o: $(arch_hdrdir)/ruby/config.h
cxxanyargs.o: $(hdrdir)/ruby/assert.h
cxxanyargs.o: $(hdrdir)/ruby/backward.h
cxxanyargs.o: $(hdrdir)/ruby/backward/cxxanyargs.hpp
cxxanyargs.o: $(hdrdir)/ruby/defines.h
cxxanyargs.o: $(hdrdir)/ruby/intern.h
cxxanyargs.o: $(hdrdir)/ruby/missing.h
cxxanyargs.o: $(hdrdir)/ruby/ruby.h
cxxanyargs.o: $(hdrdir)/ruby/st.h
cxxanyargs.o: $(hdrdir)/ruby/subst.h
cxxanyargs.o: cxxanyargs.cpp
# AUTOGENERATED DEPENDENCIES END
